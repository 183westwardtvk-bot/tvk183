<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Schedule Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  background:
    linear-gradient(rgba(0,0,0,.65), rgba(0,0,0,.65)),
    url("schedule.jpg") no-repeat center/cover;
  font-family:Segoe UI,sans-serif;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* ===== HEADER ===== */
header{
  margin:28px 0 20px;
}
header h1{
  margin:0;
  font-size:26px;
  letter-spacing:1px;
}

/* ===== ROW (CIRCLE + INPUT) ===== */
.row{
  display:flex;
  align-items:center;
  gap:18px;
  margin:14px 0;
  overflow:visible;            /* ‚úÖ prevents cropping */
}

/* ===== BIG CIRCLE BUTTON ===== */
.circle{
  width:110px;
  height:110px;
  border-radius:50%;
  background:transparent;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  position:relative;
  font-weight:600;
  font-size:14px;
  flex-shrink:0;
}

/* CENTER TEXT */
.circle span{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  line-height:1.1;
}

/* OUTLINE ONLY (RED‚ÄìYELLOW) */
.circle::before{
  content:"";
  position:absolute;
  inset:-6px;
  border-radius:50%;
  background:conic-gradient(
    #ffeb3b,
    #ff9800,
    #ff5722,
    #ffeb3b
  );
  animation:spin 3s linear infinite;
  pointer-events:none;

  /* border only */
  -webkit-mask: radial-gradient(circle, transparent 60%, black 62%);
  mask: radial-gradient(circle, transparent 60%, black 62%);
}

@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

/* ===== SIDE INPUT PANEL ===== */
.panel{
  width:0;
  min-width:0;
  overflow:hidden;
  transition:width .4s ease;
  display:flex;
  align-items:center;
}

.panel.active{
  width:260px;                /* FULLY VISIBLE */
}

.panel input,
.panel textarea{
  width:240px;
  padding:12px;
  border:none;
  border-radius:12px;
  outline:none;
  font-size:14px;
  box-sizing:border-box;
}

.panel textarea{
  resize:none;
  height:90px;
}

/* ===== SAVE BUTTON ===== */
.save{
  margin-top:26px;
  width:320px;
  padding:12px;
  border:none;
  border-radius:25px;
  background:linear-gradient(135deg,#ffeb3b,#ff5722);
  font-weight:bold;
  cursor:pointer;
}

#msg{
  margin-top:10px;
  text-align:center;
  font-size:14px;
}
/* ===== PREMIUM BACK BUTTON ===== */
.back-btn{
  position:fixed;
  top:20px;
  right:22px;
  padding:8px 18px;
  border:none;
  border-radius:25px;
  font-weight:bold;
  font-size:14px;
  cursor:pointer;
  color:#fff;
  background:linear-gradient(135deg,#ffeb3b,#ff9800,#ff5722);
  box-shadow:0 4px 15px rgba(0,0,0,0.5);
  transition:all .3s ease;
  z-index:999;
}

.back-btn:hover{
  transform:scale(1.08);
  box-shadow:0 6px 20px rgba(0,0,0,0.7);
}
/* ================= MOBILE VIEW ONLY ================= */
@media (max-width: 600px) {

  /* üì± Mobile background */
  body{
    background:
      linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
      url("sch_mob.jpg") no-repeat center/cover;

    align-items:center;
    padding:20px 12px 30px;
  }

  /* Header */
  header{
    margin:18px 0 14px;
  }

  header h1{
    font-size:20px;
    text-align:center;
  }

  /* üîÑ Each row becomes vertical */
  .row{
    flex-direction:column;
    align-items:center;
    gap:12px;
    margin:16px 0;
  }

  /* üîµ Circle button (smaller, centered) */
  .circle{
    width:90px;
    height:90px;
    font-size:13px;
  }

  .circle::before{
    inset:-4px;
  }

  /* üì¶ Input panel BELOW circle */
  .panel{
    width:100%;
    max-width:320px;
    min-width:0;
    display:none;              /* hidden by default */
    justify-content:center;
  }

  .panel.active{
    display:flex;              /* show below */
  }

  /* ‚å® Inputs & textarea aligned */
  .panel input,
  .panel textarea{
    width:100%;
    font-size:16px;            /* iPhone zoom fix */
    padding:14px;
    border-radius:14px;
  }

  .panel textarea{
    height:90px;
  }

  /* üíæ Save button */
  .save{
    width:100%;
    max-width:320px;
    height:48px;
    border-radius:26px;
    font-size:15px;
    margin-top:20px;
  }

  /* Message */
  #msg{
    font-size:14px;
    text-align:center;
    margin-top:8px;
  }

}
</style>
</head>

<body>
<button class="back-btn" onclick="goBack()">Back</button>
<header>
  <h1>Schedule Planner</h1>
</header>

<!-- DATE -->
<div class="row">
  <div class="circle" onclick="openPanel('datePanel')">
    <span>üìÖ<br>Date</span>
  </div>
  <div class="panel" id="datePanel">
    <input type="date" id="date">
  </div>
</div>

<!-- PLACE -->
<div class="row">
  <div class="circle" onclick="openPanel('placePanel')">
    <span>üìç<br>Place</span>
  </div>
  <div class="panel" id="placePanel">
    <input type="text" id="place" placeholder="Enter place">
  </div>
</div>

<!-- PLAN -->
<div class="row">
  <div class="circle" onclick="openPanel('contentPanel')">
    <span>üìù<br>Plan</span>
  </div>
  <div class="panel" id="contentPanel">
    <textarea id="content" placeholder="Plan content"></textarea>
  </div>
</div>

<button class="save" onclick="saveSchedule()">Save Plan</button>
<div id="msg"></div>

<script>
const role = sessionStorage.getItem("role");
function goBack(){
  window.location.href = "dashboard.html";
}
if (!role) {
    window.location.href = "index.html";
}
const API_URL = "https://script.google.com/macros/s/AKfycbzOLVmw7KAZ4TJWow4BV4JfZnXqp8aBI83N4c55Wca2rkGRj25y29xklPRb-a-iMYQL/exec";

/* OPEN SIDE PANEL */
function openPanel(id){
  document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
  const panel = document.getElementById(id);
  panel.classList.add("active");

  const input = panel.querySelector("input,textarea");
  if(input) setTimeout(()=>input.focus(),200);
}

/* SAVE SCHEDULE */
function saveSchedule(){
  const date = document.getElementById("date").value;
  const place = document.getElementById("place").value.trim();
  const content = document.getElementById("content").value.trim();
  const msg = document.getElementById("msg");

  if(!date || !place || !content){
    msg.style.color="#ff6b6b";
    msg.innerText="Fill all fields";
    return;
  }

  msg.style.color="#fff";
  msg.innerText="Saving...";

  fetch(API_URL,{
    method:"POST",
    headers:{ "Content-Type":"text/plain" },
    body:JSON.stringify({
      action:"saveSchedule",
      date, place, content
    })
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.success){
      msg.style.color="#4CAF50";
      msg.innerText="Schedule saved";
      setTimeout(()=>location.href="dashboard.html",1000);
    }else{
      msg.style.color="#ff6b6b";
      msg.innerText="Failed";
    }
  });
}
</script>

</body>
</html>