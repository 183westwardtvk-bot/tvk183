<!DOCTYPE html>
<html lang="en">
<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff9800">
<meta charset="UTF-8">
<title>Planner List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  background:
    linear-gradient(rgba(0,0,0,.6), rgba(0,0,0,.6)),
    url("plannerlist.jpg") no-repeat center/cover;
  font-family:Segoe UI,sans-serif;
  color:#fff;
}

/* HEADER */
.header{
  text-align:center;
  padding:22px;
  font-size:24px;
  font-weight:600;
}

/* LIST CONTAINER */
.list{
  max-width:900px;
  margin:0 auto;
  padding:0 16px 40px;
}

/* LONG TILE */
.card{
  background:rgba(255,255,255,.14);
  backdrop-filter:blur(12px);
  border-radius:16px;
  padding:16px 18px;
  margin-bottom:16px;
  box-shadow:0 8px 30px rgba(0,0,0,.5);
}

/* DATE */
.card .date{
  font-size:14px;
  color:#ffeb3b;
  margin-bottom:6px;
}

/* PLACE */
.card .place{
  font-size:16px;
  font-weight:600;
  margin-bottom:6px;
}

/* CONTENT */
.card .content{
  font-size:15px;
  opacity:.95;
  line-height:1.5;
}

/* BACK BUTTON */
.back-btn{
  position:fixed;
  top:20px;
  right:24px;
  padding:8px 20px;
  border:none;
  border-radius:25px;
  font-weight:bold;
  font-size:14px;
  cursor:pointer;
  color:#fff;
  background:linear-gradient(135deg,#ffeb3b,#ff9800,#ff5722);
  box-shadow:0 4px 15px rgba(0,0,0,.5);
  transition:all .3s ease;
}

.back-btn:hover{
  transform:scale(1.08);
  box-shadow:0 6px 20px rgba(0,0,0,.7);
}

/* Mobile view only */
@media (max-width: 600px) {

  body{
    background:
      linear-gradient(rgba(0,0,0,.7), rgba(0,0,0,.7)),
      url("planner_mob.jpeg") no-repeat center/cover;
  }

  .header{
    font-size:20px;
    padding:18px 12px;
  }

  .list{
    padding:0 12px 30px;
  }

  .card{
    padding:14px;
    border-radius:14px;
  }

  .card .date{
    font-size:13px;
  }

  .card .place{
    font-size:15px;
  }

  .card .content{
    font-size:14px;
    line-height:1.4;
  }
}
</style>
</head>

<body>

<button class="back-btn" onclick="goBack()">Back</button>
<div class="header">Planner List</div>
<div class="list" id="list">Loading...</div>

<script>
const role = sessionStorage.getItem("role");

if (!role) {
    window.location.href = "index.html";
}  

const API_URL = "https://script.google.com/macros/s/AKfycbzOLVmw7KAZ4TJWow4BV4JfZnXqp8aBI83N4c55Wca2rkGRj25y29xklPRb-a-iMYQL/exec";

/* FETCH SCHEDULE LIST */
fetch(API_URL,{
  method:"POST",
  headers:{ "Content-Type":"text/plain" },
  body:JSON.stringify({ action:"getScheduleList" })
})
.then(r=>r.json())
.then(d=>{
  const box = document.getElementById("list");
  box.innerHTML = "";

  if(!d.success || d.schedules.length === 0){
    box.innerHTML = "<p>No schedules found</p>";
    return;
  }

  const today = new Date();
  today.setHours(0,0,0,0);

  let visibleCount = 0;

  d.schedules.forEach(s=>{

    const scheduleDate = new Date(s.date);
    scheduleDate.setHours(0,0,0,0);

    if(scheduleDate >= today){

      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <div class="date">üìÖ ${s.date}</div>
        <div class="place">üìç ${s.place}</div>
        <div class="content">${s.content}</div>
      `;
      box.appendChild(div);

      visibleCount++;
    }

  });

  if(visibleCount === 0){
    box.innerHTML = "<p>No upcoming schedules</p>";
  }

});

function goBack(){
    window.location.href = "dashboard.html";
}
</script>

</body>
</html>